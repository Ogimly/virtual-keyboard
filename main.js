(()=>{"use strict";(()=>{class t{constructor(t){this.type=t.type,this.id=t.id,this.size=t.size;let{label:e}=t;Array.isArray(e)?e.forEach((t=>{this[t.lang]={low:t.low,up:t.up,caps:t.caps}})):(e=`${e}`,this.EN={low:e,up:e,caps:!1},this.RU={low:e,up:e,caps:!1}),this.keyDOM=null}createKeyToDOM(t,e){const l=document.createElement("div");l.classList.add("key_wrapper"),l.classList.add(`-${this.type}`),l.classList.add(`-${this.size}`),l.setAttribute("data-id",this.id),l.setAttribute("data-type",this.type);const a=this[t][e];l.setAttribute("data-currentKey",a);const i=document.createElement("div");return i.classList.add("key"),i.classList.add(`key_${this.type}`),i.textContent=a,l.append(i),this.keyDOM=l,l}}class e{constructor(t){this.keysArray=e.generateKeysArray(t),this.langArray=["EN","RU"],[this.lang]=this.langArray,this.getLangFromLocalStorage(),this.capsLockOn=!1,this.ShiftLeftOn=!1,this.ShiftRightOn=!1,this.ControlLeftOn=!1,this.ControlRightOn=!1,this.AltLeftOn=!1,this.AltRightOn=!1,this.userOS=`${navigator.platform}`.substring(0,3)}static generateKeysArray(e){const l=[];return e.forEach((e=>{const a=[];e.forEach((e=>{a.push(new t(e))})),l.push(a)})),l}addKeysToDOM(t){this.keysArray.forEach((e=>{const l=document.createElement("div");l.classList.add("keyboard_row"),e.forEach((t=>{const e=t.createKeyToDOM(this.lang,this.caseStatus(this.lang,t));l.append(e)})),t.append(l)}))}updateKeysInDOM(){let t=null;this.keysArray.forEach((e=>{e.forEach((e=>{t=e.keyDOM,t.firstChild.textContent=e[this.lang][this.caseStatus(this.lang,e)]}))}))}caseStatus(t,e){let l="";return l=e[t].caps?this.capsLockOn===(this.ShiftLeftOn||this.ShiftRightOn)?"low":"up":this.ShiftLeftOn||this.ShiftRightOn?"up":"low",l}findKeyOnCode(t){let e=null;return this.keysArray.forEach((l=>{l.forEach((l=>{l.id===t&&(e=l)}))})),e}getLangFromLocalStorage(){localStorage.getItem("virtual-keyboard.lang")?this.lang=localStorage.getItem("virtual-keyboard.lang"):localStorage.setItem("virtual-keyboard.lang",this.lang)}switchLanguage(){this.lang=this.langArray[(this.langArray.indexOf(this.lang)+1)%this.langArray.length],localStorage.setItem("virtual-keyboard.lang",this.lang)}switchKey(t,e){"CapsLock"===t&&(this.capsLockOn=!this.capsLockOn),"ShiftLeft"===t&&(this.ShiftLeftOn=!this.ShiftLeftOn),"ShiftRight"===t&&(this.ShiftRightOn=!this.ShiftRightOn),"ControlLeft"===t&&(this.ControlLeftOn=!this.ControlLeftOn),"ControlRight"===t&&(this.ControlRightOn=!this.ControlRightOn),"AltLeft"===t&&(this.AltLeftOn=!this.AltLeftOn),"AltRight"===t&&(this.AltRightOn=!this.AltRightOn),e.keyDOM.firstChild.classList.toggle("-active")}clearKeyDown(t){this[`${t}LeftOn`]=!1,this[`${t}RightOn`]=!1;let e=this.findKeyOnCode(`${t}Left`).keyDOM.firstChild;e.classList.remove("-active"),e=this.findKeyOnCode(`${t}Right`).keyDOM.firstChild,e.classList.remove("-active")}hotKeyPressed(t){return this.ShiftLeftOn&&!("ShiftLeft"===t)||this.ShiftRightOn&&!("ShiftRight"===t)||this.ControlLeftOn&&!("ControlLeft"===t)||this.ControlRightOn&&!("ControlRight"===t)||this.AltLeftOn&&!("AltLeft"===t)||this.AltRightOn&&!("AltRight"===t)}getHotKey(t){return this.ShiftLeftOn?`ShiftLeft + ${t}`:this.ShiftRightOn?`ShiftRight + ${t}`:this.ControlLeftOn?`ControlLef + ${t}`:this.ControlRightOn?`ControlRight + ${t}`:this.AltLeftOn?`AltLeft + ${t}`:this.AltRightOn?`AltRight + ${t}`:"none"}}const l=[{key:"русский ",text:" военный корабль таки да"},{key:"а я вам ",text:" сейчас покажу откуда на Беларусь готовилось нападение"},{key:"Слава Украине! ",text:" Героям слава!"}],a=new e([[{type:"abc",id:"Backquote",size:"mini",label:[{lang:"EN",low:"`",up:"~",caps:!1},{lang:"RU",low:"ё",up:"Ё",caps:!0}]},{type:"abc",id:"Digit2",size:"mini",label:[{lang:"EN",low:"2",up:"@",caps:!1},{lang:"RU",low:"2",up:'"',caps:!1}]},{type:"abc",id:"Digit3",size:"mini",label:[{lang:"EN",low:"3",up:"#",caps:!1},{lang:"RU",low:"3",up:"№",caps:!1}]},{type:"abc",id:"Digit4",size:"mini",label:[{lang:"EN",low:"4",up:"$",caps:!1},{lang:"RU",low:"4",up:";",caps:!1}]},{type:"abc",id:"Digit1",size:"mini",label:[{lang:"EN",low:"1",up:"!",caps:!1},{lang:"RU",low:"1",up:"!",caps:!1}]},{type:"abc",id:"Digit5",size:"mini",label:[{lang:"EN",low:"5",up:"%",caps:!1},{lang:"RU",low:"5",up:"%",caps:!1}]},{type:"abc",id:"Digit6",size:"mini",label:[{lang:"EN",low:"6",up:"^",caps:!1},{lang:"RU",low:"6",up:":",caps:!1}]},{type:"abc",id:"Digit7",size:"mini",label:[{lang:"EN",low:"7",up:"&",caps:!1},{lang:"RU",low:"7",up:"?",caps:!1}]},{type:"abc",id:"Digit8",size:"mini",label:[{lang:"EN",low:"8",up:"*",caps:!1},{lang:"RU",low:"8",up:"*",caps:!1}]},{type:"abc",id:"Digit9",size:"mini",label:[{lang:"EN",low:"9",up:"(",caps:!1},{lang:"RU",low:"9",up:"(",caps:!1}]},{type:"abc",id:"Digit0",size:"mini",label:[{lang:"EN",low:"0",up:")",caps:!1},{lang:"RU",low:"0",up:")",caps:!1}]},{type:"abc",id:"Minus",size:"mini",label:[{lang:"EN",low:"-",up:"_",caps:!1},{lang:"RU",low:"-",up:"_",caps:!1}]},{type:"abc",id:"Equal",size:"mini",label:[{lang:"EN",low:"=",up:"+",caps:!1},{lang:"RU",low:"=",up:"+",caps:!1}]},{type:"ctrl",id:"Backspace",size:"large",label:"Backspace"}],[{type:"ctrl",id:"Tab",size:"midi",label:"Tab"},{type:"abc",id:"KeyQ",size:"mini",label:[{lang:"EN",low:"q",up:"Q",caps:!0},{lang:"RU",low:"й",up:"Й",caps:!0}]},{type:"abc",id:"KeyW",size:"mini",label:[{lang:"EN",low:"w",up:"W",caps:!0},{lang:"RU",low:"ц",up:"Ц",caps:!0}]},{type:"abc",id:"KeyE",size:"mini",label:[{lang:"EN",low:"e",up:"E",caps:!0},{lang:"RU",low:"у",up:"У",caps:!0}]},{type:"abc",id:"KeyR",size:"mini",label:[{lang:"EN",low:"r",up:"R",caps:!0},{lang:"RU",low:"к",up:"К",caps:!0}]},{type:"abc",id:"KeyT",size:"mini",label:[{lang:"EN",low:"t",up:"T",caps:!0},{lang:"RU",low:"е",up:"Е",caps:!0}]},{type:"abc",id:"KeyY",size:"mini",label:[{lang:"EN",low:"y",up:"Y",caps:!0},{lang:"RU",low:"н",up:"Н",caps:!0}]},{type:"abc",id:"KeyU",size:"mini",label:[{lang:"EN",low:"u",up:"U",caps:!0},{lang:"RU",low:"г",up:"Г",caps:!0}]},{type:"abc",id:"KeyI",size:"mini",label:[{lang:"EN",low:"i",up:"I",caps:!0},{lang:"RU",low:"ш",up:"Ш",caps:!0}]},{type:"abc",id:"KeyO",size:"mini",label:[{lang:"EN",low:"o",up:"O",caps:!0},{lang:"RU",low:"щ",up:"Щ",caps:!0}]},{type:"abc",id:"KeyP",size:"mini",label:[{lang:"EN",low:"p",up:"P",caps:!0},{lang:"RU",low:"з",up:"З",caps:!0}]},{type:"abc",id:"BracketLeft",size:"mini",label:[{lang:"EN",low:"[",up:"{",caps:!1},{lang:"RU",low:"х",up:"Х",caps:!0}]},{type:"abc",id:"BracketRight",size:"mini",label:[{lang:"EN",low:"]",up:"}",caps:!1},{lang:"RU",low:"ъ",up:"Ъ",caps:!0}]},{type:"ctrl",id:"Delete",size:"midi",label:"Delete"}],[{type:"ctrl",id:"CapsLock",size:"large",label:"CapsLock"},{type:"abc",id:"KeyA",size:"mini",label:[{lang:"EN",low:"a",up:"A",caps:!0},{lang:"RU",low:"ф",up:"Ф",caps:!0}]},{type:"abc",id:"KeyS",size:"mini",label:[{lang:"EN",low:"s",up:"S",caps:!0},{lang:"RU",low:"ы",up:"Ы",caps:!0}]},{type:"abc",id:"KeyD",size:"mini",label:[{lang:"EN",low:"d",up:"D",caps:!0},{lang:"RU",low:"в",up:"В",caps:!0}]},{type:"abc",id:"KeyF",size:"mini",label:[{lang:"EN",low:"f",up:"F",caps:!0},{lang:"RU",low:"а",up:"А",caps:!0}]},{type:"abc",id:"KeyG",size:"mini",label:[{lang:"EN",low:"g",up:"G",caps:!0},{lang:"RU",low:"п",up:"П",caps:!0}]},{type:"abc",id:"KeyH",size:"mini",label:[{lang:"EN",low:"h",up:"H",caps:!0},{lang:"RU",low:"р",up:"Р",caps:!0}]},{type:"abc",id:"KeyJ",size:"mini",label:[{lang:"EN",low:"j",up:"J",caps:!0},{lang:"RU",low:"о",up:"О",caps:!0}]},{type:"abc",id:"KeyK",size:"mini",label:[{lang:"EN",low:"k",up:"K",caps:!0},{lang:"RU",low:"л",up:"Л",caps:!0}]},{type:"abc",id:"KeyL",size:"mini",label:[{lang:"EN",low:"l",up:"L",caps:!0},{lang:"RU",low:"д",up:"Д",caps:!0}]},{type:"abc",id:"Semicolon",size:"mini",label:[{lang:"EN",low:";",up:":",caps:!1},{lang:"RU",low:"ж",up:"Ж",caps:!0}]},{type:"abc",id:"Quote",size:"mini",label:[{lang:"EN",low:"'",up:'"',caps:!1},{lang:"RU",low:"э",up:"Э",caps:!0}]},{type:"ctrl",id:"Enter",size:"large",label:"Enter"}],[{type:"ctrl",id:"ShiftLeft",size:"midi",label:"Shift"},{type:"abc",id:"Backslash",size:"mini",label:[{lang:"EN",low:"\\",up:"|",caps:!1},{lang:"RU",low:"\\",up:"/",caps:!1}]},{type:"abc",id:"KeyZ",size:"mini",label:[{lang:"EN",low:"z",up:"Z",caps:!0},{lang:"RU",low:"я",up:"Я",caps:!0}]},{type:"abc",id:"KeyX",size:"mini",label:[{lang:"EN",low:"x",up:"X",caps:!0},{lang:"RU",low:"ч",up:"Ч",caps:!0}]},{type:"abc",id:"KeyC",size:"mini",label:[{lang:"EN",low:"c",up:"C",caps:!0},{lang:"RU",low:"с",up:"С",caps:!0}]},{type:"abc",id:"KeyV",size:"mini",label:[{lang:"EN",low:"v",up:"V",caps:!0},{lang:"RU",low:"м",up:"М",caps:!0}]},{type:"abc",id:"KeyB",size:"mini",label:[{lang:"EN",low:"b",up:"B",caps:!0},{lang:"RU",low:"и",up:"И",caps:!0}]},{type:"abc",id:"KeyN",size:"mini",label:[{lang:"EN",low:"n",up:"N",caps:!0},{lang:"RU",low:"т",up:"Т",caps:!0}]},{type:"abc",id:"KeyM",size:"mini",label:[{lang:"EN",low:"m",up:"M",caps:!0},{lang:"RU",low:"ь",up:"Ь",caps:!0}]},{type:"abc",id:"Comma",size:"mini",label:[{lang:"EN",low:",",up:",",caps:!1},{lang:"RU",low:"б",up:"Б",caps:!0}]},{type:"abc",id:"Period",size:"mini",label:[{lang:"EN",low:".",up:".",caps:!1},{lang:"RU",low:"ю",up:"Ю",caps:!0}]},{type:"abc",id:"Slash",size:"mini",label:[{lang:"EN",low:"/",up:"?",caps:!1},{lang:"RU",low:".",up:",",caps:!1}]},{type:"arrow",id:"ArrowUp",size:"mini",label:"↑"},{type:"ctrl",id:"ShiftRight",size:"midi",label:"Shift"}],[{type:"ctrl",id:"ControlLeft",size:"mini",label:"Ctrl"},{type:"ctrl",id:"Lang",size:"mini",label:[{lang:"EN",low:"EN",up:"EN",caps:!0},{lang:"RU",low:"RU",up:"RU",caps:!1}]},{type:"ctrl",id:"AltLeft",size:"mini",label:"Alt"},{type:"abc",id:"Space",size:"space",label:" "},{type:"ctrl",id:"AltRight",size:"mini",label:"Alt"},{type:"ctrl",id:"ControlRight",size:"mini",label:"Ctrl"},{type:"arrow",id:"ArrowLeft",size:"mini",label:"←"},{type:"arrow",id:"ArrowDown",size:"mini",label:"↓"},{type:"arrow",id:"ArrowRight",size:"mini",label:"→"}]]);let i=null,n=null,s=null,p=null;const o=t=>{n.focus();let e="";const i=a.findKeyOnCode(t);if(i){let p=n.selectionStart,o=n.selectionEnd;const c=n.value.substring(0,p),r=n.value.substring(o);a.hotKeyPressed(t)?"abc"===i.type&&(a.ShiftLeftOn||a.ShiftRightOn)?e=i.keyDOM.firstChild.textContent:(a.ShiftLeftOn||a.ShiftRightOn)&&"ArrowLeft"===t?e="←←":(a.ShiftLeftOn||a.ShiftRightOn)&&"ArrowRight"===t?e="→→":(a.ShiftLeftOn||a.ShiftRightOn)&&("ControlLeft"===t||"ControlRight"===t)||(a.ControlLeftOn||a.ControlRightOn)&&("ShiftLeft"===t||"ShiftRight"===t)?(a.switchLanguage(),a.updateKeysInDOM()):(s.textContent=`<${a.getHotKey(t)}> was pressed`,e="",s.classList.remove("-hidden"),window.setTimeout((()=>{s.classList.add("-hidden")}),3e3)):"Lang"===t?(a.switchLanguage(),a.updateKeysInDOM()):"CapsLock"===t||"ShiftLeft"===t||"ShiftRight"===t?(a.switchKey(t,i),a.updateKeysInDOM()):"ControlLeft"===t||"ControlRight"===t||"AltLeft"===t||"AltRight"===t?a.switchKey(t,i):"abc"===i.type?e=i.keyDOM.firstChild.textContent:"Enter"===t?e="\n":"Tab"===t?e="\t":"Backspace"===t?e="Backspace":"Delete"===t?e="Delete":"ArrowLeft"===t?e="←":"ArrowRight"===t?e="→":"ArrowUp"===t?e="↑":"ArrowDown"===t&&(e="↓"),e&&("Backspace"===e?p===o?(n.value=c.slice(0,-1)+r,p=0===p?0:p-1,o=p):(n.value=c+r,o=p):"Delete"===e?p===o?n.value=c+r.slice(1):(n.value=c+r,o=p):"←"===e?(p=0===p?0:p-1,o=p):"←←"===e?(p=0===p?0:p-1,n.selectionDirection="backward"):"→"===e?(p=p===n.value.length-1?n.value.length:p+1,o=p):"→→"===e?(o=o===n.value.length-1?n.value.length:o+1,n.selectionDirection="forward"):(n.value=c+e+r,p=p===n.value.length-1?n.value.length:p+e.length,o=p),e=(()=>{let t="";const e=n.value.toUpperCase();return l.forEach((l=>{const a=l.key.toUpperCase();e.slice(e.length-a.length)===a&&(t=l.text)})),t})(),e&&(n.value=c+e+r,p=p===n.value.length-1?n.value.length:p+e.length,o=p),n.selectionStart=p,n.selectionEnd=o)}},c=t=>{if(t){const e=t.firstChild;e&&e.classList.add("-pressed")}},r=t=>{if(t){const e=t.firstChild;e&&e.classList.remove("-pressed")}},g=t=>{const e=t.target.closest(".key_wrapper");e&&(c(e),p=e)},h=t=>{if(p){const e=t.target.closest(".key_wrapper");if(e){const l=e.getAttribute("data-id");l===p.getAttribute("data-id")?(t.preventDefault(),o(l),(a.ShiftLeftOn||a.ShiftRightOn)&&"ShiftLeft"!==l&&"ShiftRight"!==l&&(a.clearKeyDown("Shift"),a.updateKeysInDOM()),(a.ControlLeftOn||a.ControlRightOn)&&"ControlLeft"!==l&&"ControlRight"!==l&&a.clearKeyDown("Control"),(a.AltLeftOn||a.AltRightOn)&&"AltLeft"!==l&&"AltRight"!==l&&a.clearKeyDown("Alt"),r(e)):r(p)}else r(p);p=null}},d=t=>{const{code:e}=t,l=document.querySelector(`.key_wrapper[data-id='${e}']`);t.preventDefault(),("ShiftLeft"!==e&&"ShiftRight"!==e||!a.ShiftLeftOn&&!a.ShiftRightOn)&&o(e),l&&c(l),"CapsLock"===e&&"Mac"===a.userOS&&window.setTimeout((()=>l.firstChild.classList.remove("-pressed")),300)},u=t=>{const{code:e}=t,l=document.querySelector(`.key_wrapper[data-id='${e}']`);l&&r(l),"ShiftLeft"!==e&&"ShiftRight"!==e||(a.clearKeyDown("Shift"),a.updateKeysInDOM()),"ControlLeft"!==e&&"ControlRight"!==e||a.clearKeyDown("Control"),"AltLeft"!==e&&"AltRight"!==e||a.clearKeyDown("Alt")};window.onload=()=>{(()=>{const t=document.createElement("main");t.classList.add("wrapper");const e=document.createElement("h1");e.textContent="Virtual keyboard (Windows)",t.append(e),n=document.createElement("textarea"),n.rows=6,t.append(n),s=document.createElement("p"),s.classList.add("-hidden"),s.textContent="hot key",t.append(s),i=document.createElement("div"),i.classList.add("keyboard_wrapper"),t.append(i);const l=document.createElement("p");l.textContent="Change language <Shift + Ctrl>",t.append(l),document.body.append(t)})(),a.addKeysToDOM(i),document.addEventListener("mousedown",g),document.addEventListener("mouseup",h),document.addEventListener("keydown",d),document.addEventListener("keyup",u)}})()})();