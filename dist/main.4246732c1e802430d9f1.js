(()=>{"use strict";(()=>{class e{constructor(e,i,t){this.row=i,this.number=t,this.type=e.type,this.id=e.id,this.size=e.size;let{label:a}=e;Array.isArray(a)?(this.EN={low:a[0],up:a[1]},this.RU={low:a[2],up:a[3]}):(a=`${a}`,this.EN={low:a,up:a},this.RU={low:a,up:a}),this.keyDOM=null}createKeyToDOM(e,i){const t=document.createElement("div");t.classList.add("key_wrapper"),t.classList.add(`-${this.type}`),t.classList.add(`-${this.size}`),t.setAttribute("data-id",this.id),t.setAttribute("data-type",this.type);const a=this[e][i];t.setAttribute("data-currentKey",a);const s=document.createElement("div");return s.classList.add("key"),s.classList.add(`key_${this.type}`),s.textContent=a,t.append(s),this.keyDOM=t,t}}class i{constructor(e){this.keysArray=i.generateKeysArray(e),this.langArray=["EN","RU"],[this.lang]=this.langArray,this.getLangFromLocalStorage(),this.capsLockOn=!1,this.ShiftLeftOn=!1,this.ShiftRightOn=!1}static generateKeysArray(i){const t=[];for(let a=0;a<i.length;a+=1){const s=i[a],l=[];for(let i=0;i<s.length;i+=1)l.push(new e(s[i],a,i));t.push(l)}return t}addKeysToDOM(e){for(let i=0;i<this.keysArray.length;i+=1){const t=document.createElement("div");t.classList.add("keyboard_row");const a=this.keysArray[i];for(let e=0;e<a.length;e+=1){const i=a[e].createKeyToDOM(this.lang,this.caseStatus());t.append(i)}e.append(t)}}updateKeysInDOM(){let e=null;for(let i=0;i<this.keysArray.length;i+=1){const t=this.keysArray[i];for(let i=0;i<t.length;i+=1)e=t[i].keyDOM,e.firstChild.textContent=t[i][this.lang][this.caseStatus()]}}caseStatus(){return this.capsLockOn===(this.ShiftLeftOn||this.ShiftRightOn)?"low":"up"}findKeyOnCode(e){let i=null;for(let t=0;t<this.keysArray.length;t+=1){const a=this.keysArray[t];for(let t=0;t<a.length;t+=1)if(a[t].id===e){i=a[t];break}}return i}getLangFromLocalStorage(){localStorage.getItem("virtual-keyboard.lang")?this.lang=localStorage.getItem("virtual-keyboard.lang"):localStorage.setItem("virtual-keyboard.lang",this.lang)}switchLanguage(){this.lang=this.langArray[(this.langArray.indexOf(this.lang)+1)%this.langArray.length],localStorage.setItem("virtual-keyboard.lang",this.lang)}switchCase(e){"CapsLock"===e&&(this.capsLockOn=!this.capsLockOn),"ShiftLeft"===e&&(this.ShiftLeftOn=!this.ShiftLeftOn),"ShiftRight"===e&&(this.ShiftRight=!this.ShiftRight)}clearShiftDown(){this.ShiftLeftOn=!1,this.ShiftRight=!1;let e=this.findKeyOnCode("ShiftLeft").keyDOM.firstChild;e.classList.remove("-active"),e=this.findKeyOnCode("ShiftRight").keyDOM.firstChild,e.classList.remove("-active")}update(e){if(e){const i=this.findKeyOnCode(e);i&&("abc"===i.type?(this.ShiftLeftOn||this.ShiftRightOn)&&(this.clearShiftDown(),this.updateKeysInDOM()):"Lang"===e?(this.switchLanguage(),this.updateKeysInDOM()):"CapsLock"!==e&&"ShiftLeft"!==e&&"ShiftRight"!==e||(this.switchCase(e),this.updateKeysInDOM()))}}}const t=new i([[{type:"abc",id:"Backquote",size:"mini",label:["`","~","ё","Ё"]},{type:"abc",id:"Digit1",size:"mini",label:["1","!","1","!"]},{type:"abc",id:"Digit2",size:"mini",label:["2","@","2",'"']},{type:"abc",id:"Digit3",size:"mini",label:["3","#","3","№"]},{type:"abc",id:"Digit4",size:"mini",label:["4","$","4",";"]},{type:"abc",id:"Digit5",size:"mini",label:["5","%","5","%"]},{type:"abc",id:"Digit6",size:"mini",label:["6","^","6","?"]},{type:"abc",id:"Digit7",size:"mini",label:["7","&","7","?"]},{type:"abc",id:"Digit8",size:"mini",label:["8","*","8","*"]},{type:"abc",id:"Digit9",size:"mini",label:["9","(","9","("]},{type:"abc",id:"Digit0",size:"mini",label:["0",")","0",")"]},{type:"abc",id:"Minus",size:"mini",label:["-","_","-","_"]},{type:"abc",id:"Equal",size:"mini",label:["=","+","=","+"]},{type:"ctrl",id:"Backspace",size:"large",label:"Backspaсe"}],[{type:"ctrl",id:"Tab",size:"midi",label:"Tab"},{type:"abc",id:"KeyQ",size:"mini",label:["q","Q","й","Й"]},{type:"abc",id:"KeyW",size:"mini",label:["w","W","ц","Ц"]},{type:"abc",id:"KeyE",size:"mini",label:["e","E","у","У"]},{type:"abc",id:"KeyR",size:"mini",label:["r","R","к","К"]},{type:"abc",id:"KeyT",size:"mini",label:["t","T","е","Е"]},{type:"abc",id:"KeyY",size:"mini",label:["y","Y","н","Н"]},{type:"abc",id:"KeyU",size:"mini",label:["u","U","г","Г"]},{type:"abc",id:"KeyI",size:"mini",label:["i","I","ш","Ш"]},{type:"abc",id:"KeyO",size:"mini",label:["o","O","щ","Щ"]},{type:"abc",id:"KeyP",size:"mini",label:["p","P","з","З"]},{type:"abc",id:"BracketLeft",size:"mini",label:["[","{","х","Х"]},{type:"abc",id:"BracketRight",size:"mini",label:["]","}","ъ","Ъ"]},{type:"ctrl",id:"Delete",size:"midi",label:"Delete"}],[{type:"ctrl",id:"CapsLock",size:"large",label:"CapsLock"},{type:"abc",id:"KeyA",size:"mini",label:["a","A","ф","Ф"]},{type:"abc",id:"KeyS",size:"mini",label:["s","S","ы","Ы"]},{type:"abc",id:"KeyD",size:"mini",label:["d","D","в","В"]},{type:"abc",id:"KeyF",size:"mini",label:["f","F","а","А"]},{type:"abc",id:"KeyG",size:"mini",label:["g","G","п","П"]},{type:"abc",id:"KeyH",size:"mini",label:["h","H","р","Р"]},{type:"abc",id:"KeyJ",size:"mini",label:["j","J","о","О"]},{type:"abc",id:"KeyK",size:"mini",label:["k","K","л","Л"]},{type:"abc",id:"KeyL",size:"mini",label:["l","L","д","Д"]},{type:"abc",id:"Semicolon",size:"mini",label:[";",":","ж","Ж"]},{type:"abc",id:"Quote",size:"mini",label:["'",'"',"э","Э"]},{type:"ctrl",id:"Enter",size:"large",label:"Enter"}],[{type:"ctrl",id:"ShiftLeft",size:"midi",label:"Shift"},{type:"abc",id:"Backslash",size:"mini",label:["\\","|","\\","/"]},{type:"abc",id:"KeyZ",size:"mini",label:["z","Z","я","Я"]},{type:"abc",id:"KeyX",size:"mini",label:["x","X","ч","Ч"]},{type:"abc",id:"KeyC",size:"mini",label:["c","C","с","С"]},{type:"abc",id:"KeyV",size:"mini",label:["v","V","м","М"]},{type:"abc",id:"KeyB",size:"mini",label:["b","B","и","И"]},{type:"abc",id:"KeyN",size:"mini",label:["n","N","т","Т"]},{type:"abc",id:"KeyM",size:"mini",label:["m","M","ь","Ь"]},{type:"abc",id:"Comma",size:"mini",label:[",",",","б","Б"]},{type:"abc",id:"Period",size:"mini",label:[".",".","ю","Ю"]},{type:"abc",id:"Slash",size:"mini",label:["/","?",".",","]},{type:"arrow",id:"ArrowUp",size:"mini",label:"↑"},{type:"ctrl",id:"ShiftRight",size:"midi",label:"Shift"}],[{type:"ctrl",id:"ControlLeft",size:"mini",label:"Ctrl"},{type:"ctrl",id:"Lang",size:"mini",label:["EN","EN","RU","RU"]},{type:"ctrl",id:"AltLeft",size:"mini",label:"Alt"},{type:"abc",id:"Space",size:"space",label:" "},{type:"ctrl",id:"AltRight",size:"mini",label:"Alt"},{type:"ctrl",id:"ControlRight",size:"mini",label:"Ctrl"},{type:"arrow",id:"ArrowLeft",size:"mini",label:"←"},{type:"arrow",id:"ArrowDown",size:"mini",label:"↓"},{type:"arrow",id:"ArrowRight",size:"mini",label:"←"}]]);let a=null,s=null;const l=e=>{if(e){const i=e.firstChild;i&&i.classList.add("-pressed")}},n=(e,i)=>{if(e){t.update(i);const a=e.firstChild;a&&(a.classList.remove("-pressed"),"CapsLock"!==i&&"ShiftLeft"!==i&&"ShiftRight"!==i||a.classList.toggle("-active"))}},d=e=>{const i=e.target.closest(".key_wrapper");i&&(l(i),s=i)},r=e=>{if(s){const i=e.target.closest(".key_wrapper");if(i){const e=i.getAttribute("data-id");e===s.getAttribute("data-id")?n(i,e):s.firstChild.classList.remove("-pressed")}else s.firstChild.classList.remove("-pressed");s=null}},c=e=>{const{code:i}=e,t=document.querySelector(`.key_wrapper[data-id='${i}']`);t&&l(t)},y=e=>{const{code:i}=e,t=document.querySelector(`.key_wrapper[data-id='${i}']`);t&&n(t,i)};window.onload=()=>{a=(()=>{const e=document.createElement("main");e.classList.add("wrapper");const i=document.createElement("h1");i.textContent="Virtual keyboard (Windows)",e.append(i);const t=document.createElement("textarea");t.rows=6,e.append(t);const a=document.createElement("div");return a.classList.add("keyboard_wrapper"),e.append(a),document.body.append(e),a})(),t.addKeysToDOM(a),document.addEventListener("mousedown",d),document.addEventListener("mouseup",r),document.addEventListener("keydown",c),document.addEventListener("keyup",y)}})()})();